# RW1 预实验报告 - 修正版（真实数据）

## 实验设计修正说明

本次实验修正了之前实验设计中的关键问题：

| 假设 | 原问题 | 修正方案 |
|------|--------|----------|
| H1 | 未正确构造分布偏移场景 | 使用自然偏移 + Dirichlet人工偏移 |
| H3 | 使用人工proxy而非真实噪声指标 | 使用实体距离、句长方差等自然指标 |
| H5 | 将"标签一致性"误作"可靠性" | 使用 yes/(yes+no) 比例作为可靠性 |

---

## 实验结果摘要

**总体结果: 1/3 假设通过验证**

| 假设 | 描述 | 主要指标 | 阈值 | 实际值 | 结果 |
|------|------|----------|------|--------|------|
| H1 | 分布偏移 → F1下降 | Pearson r | > 0.8 | **0.9685** | ✅ 通过 |
| H3 | PDI → 噪声率 | Pearson r | > 0.5 | 0.0483 | ❌ 失败 |
| H5 | 包大小 → 可靠性 | Cohen's d | 0.5-0.8 | 0.0780 | ❌ 失败 |

---

## 详细分析

### H1: 分布偏移 → F1下降 ✅ 通过

**结果**: Pearson r = 0.9685, p < 0.001

**分析**:
- 使用NYT10的自然train/test分布差异（JS=0.057）
- 通过Dirichlet重采样创建8个人工偏移场景（JS范围: 0.02-0.40）
- F1下降与JS散度呈现**极强正相关**

**结论**: 假设H1得到强有力支持。分布偏移确实导致性能下降，建议优先研究此方向。

```
Natural JS divergence: 0.0569
Pearson r: 0.9685 (p=0.000018)
Spearman ρ: 0.9500 (p=0.000088)
```

---

### H3: PDI → 噪声率 ❌ 失败

**结果**: Pearson r = 0.0483, p = 0.827

**分析**:
- 分析了23个关系（样本数≥100）
- PDI（原型分散指数）与噪声率**无显著相关**
- **重要发现**: 实体距离与噪声率呈显著相关（r=0.64, p<0.001）

**关键洞察**:
```
PDI vs Noise Rate:       r = 0.05 (p = 0.83) ❌
Entity Distance vs Noise: r = 0.64 (p < 0.001) ✅
```

**建议**:
- 放弃PDI作为噪声指标
- 改用**实体距离**作为噪声预测因子
- 重新设计H3假设：`实体距离 → 噪声率`

---

### H5: 包大小 → 可靠性 ❌ 失败（效应过小）

**结果**: Cohen's d = 0.078

**分析**:
- 修正后使用 yes/(yes+no) 作为可靠性指标
- Size=1包: 平均可靠性 0.5515
- Size≥3包: 平均可靠性 0.5876
- 效应方向正确（大包可靠性略高）但幅度很小

**关键发现**:
```
Size 1:   n=2116, reliability=0.5515
Size 2:   n=607,  reliability=0.5519
Size 3:   n=269,  reliability=0.6047
Size 4:   n=142,  reliability=0.6144
Size 5+:  n=414,  reliability=0.5672
```

**解释**:
- 在NYT-H数据集中，包大小对可靠性的影响非常微弱
- 可能原因：NYT-H的标注质量本身较高，包大小差异不明显
- 或者：假设本身不成立，包大小不是可靠性的主要决定因素

---

## 三次实验对比

| 假设 | 合成数据 | 真实数据(v1) | 真实数据(v2-修正) | 变化趋势 |
|------|----------|--------------|-------------------|----------|
| H1 | r=1.00 ✅ | r=0.11 ❌ | r=0.97 ✅ | 修正后恢复 |
| H3 | r=0.72 ✅ | r=0.03 ❌ | r=0.05 ❌ | 假设需重构 |
| H5 | d=1.27 ❌ | d=-1.94 ❌ | d=0.08 ❌ | 方向正确但弱 |

---

## 结论与建议

### 1. 继续推进 H1 (LDA-LLM方向)
- **理由**: 分布偏移与性能下降的相关性极强(r=0.97)
- **方法**: 使用LLM生成域适应数据来减轻分布偏移

### 2. 重构 H3 假设
- **原假设**: PDI → 噪声率 (失败)
- **新假设**: 实体距离 → 噪声率 (r=0.64, 有支持)
- **建议**: 基于实体距离的噪声检测/过滤方法

### 3. 重新评估 H5
- **发现**: 包大小效应存在但非常弱 (d=0.08)
- **建议**:
  - 考虑是否值得在此方向投入
  - 或寻找更强的可靠性预测因子

---

## 数据来源声明

所有实验使用真实数据集：

| 数据集 | 来源 | 样本数 | 验证状态 |
|--------|------|--------|----------|
| NYT10 | Aliyun OSS (OpenNRE) | 522,611 | ✅ 验证通过 |
| NYT-H | Google Drive | 9,955 | ✅ 验证通过 |

---

## 文件列表

- `results/h1_fixed/h1_results.json` - H1修正实验结果
- `results/h3_fixed/h3_results.json` - H3修正实验结果
- `results/h5_fixed/h5_results.json` - H5修正实验结果
- `scripts/run_h1_fixed.py` - H1修正实验脚本
- `scripts/run_h3_fixed.py` - H3修正实验脚本
- `scripts/run_h5_fixed.py` - H5修正实验脚本
