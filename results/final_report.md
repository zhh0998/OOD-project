# RW1 预实验最终报告

## 实验版本历史

| 版本 | 日期 | 主要变化 | 结果 |
|------|------|----------|------|
| v1 (合成数据) | - | 使用paper-based合成数据 | 2/5 通过 |
| v2 (真实数据) | - | 下载真实NYT10/NYT-H | 0/3 通过 |
| v3 (修正设计) | - | 修正实验设计问题 | 1/3 通过 |
| **v4 (最终)** | - | 使用真实模型 + 重构H3 | **1/3 通过** |

---

## 最终实验结果

### 总结: 1/3 假设通过验证

| 假设 | 描述 | 指标 | 阈值 | 结果 | 状态 |
|------|------|------|------|------|------|
| H1 | 分布偏移 → F1下降 | r | > 0.5 | **-0.93** | ❌ 失败 |
| H3 (修订) | 实体距离 → 噪声率 | r | > 0.5 | **0.75** | ✅ 通过 |
| H5 | 包大小 → 可靠性 | d | 0.5-0.8 | 0.08 | ❌ 失败 |

---

## 详细分析

### H1: 分布偏移 → F1下降 ❌ 失败

**方法**: TF-IDF + Logistic Regression (真实模型训练)

**发现**:
```
Baseline F1 (macro): 0.047
Pearson r: -0.93 (p=0.0009)
Spearman ρ: -0.98 (p=0.00003)
```

**关键洞察**:
1. **负相关**: 分布偏移增加时，F1反而略微提升
2. **原因分析**:
   - 原始测试集高度偏斜（NA占主导）
   - 向均匀分布偏移实际上让任务变简单
   - baseline模型性能过低（欠拟合严重）

**结论**:
- 原假设"分布偏移导致性能下降"过于简化
- 实际关系取决于偏移的方向和程度
- 之前r=0.97的结果确实是循环推理

**建议**:
- 需要更精细的分布偏移建模
- 考虑区分"有害偏移"和"有益偏移"
- 使用更强的baseline模型重新验证

---

### H3 (修订): 实体距离 → 噪声率 ✅ 通过

**重构原因**: 原PDI假设失败(r=0.05)，但发现实体距离信号强

**发现**:
```
Relations analyzed: 23
Pearson r: 0.7544 (p=0.00003)
Spearman ρ: 0.6490 (p=0.0008)
```

**关键洞察**:
1. **强相关**: 实体距离越大，噪声率越高
2. **Top 3高噪声关系**:
   - /people/person/religion (dist=83.7, noise=47%)
   - /people/deceased_person/place_of_death (dist=92.5, noise=46%)
   - /business/person/company (dist=52.9, noise=45%)

**结论**:
- 实体距离是有效的噪声预测因子
- 可用于设计基于距离的噪声过滤策略
- 建议替代原PDI假设

**建议方法设计**:
```
噪声过滤策略:
- 距离 > 80 tokens → 高噪声警告
- 距离 > 50 tokens → 中等噪声风险
- 距离 < 30 tokens → 相对可靠
```

---

### H5: 包大小 → 可靠性 ❌ 失败

**发现** (之前实验):
```
Cohen's d: 0.08 (阈值: 0.5-0.8)
方向正确但效应过小
```

**结论**:
- 包大小对可靠性的影响非常微弱
- 在NYT-H数据集中，这一假设不成立
- 可能需要寻找其他可靠性预测因子

---

## 实验演进总结

### H1的教训

| 版本 | 方法 | r值 | 问题 |
|------|------|-----|------|
| v1 | 合成数据 | 1.00 | 数据本身按假设生成 |
| v3 | 模拟F1下降 | 0.97 | 循环推理 (F1=f(JS)) |
| **v4** | **真实模型** | **-0.93** | **真实结果** |

**核心教训**: 永远不要用公式模拟实验结果

### H3的收获

| 版本 | 假设 | r值 | 状态 |
|------|------|-----|------|
| v1-v3 | PDI → 噪声 | 0.03-0.05 | ❌ |
| **v4** | **实体距离 → 噪声** | **0.75** | ✅ |

**核心收获**: 失败的实验可能隐藏更强的发现

---

## 最终建议

### 1. 放弃H1原始形式
- 分布偏移与F1的关系比预期复杂
- 需要更精细的理论框架

### 2. 采用H3修订版
- **实体距离**是强噪声信号 (r=0.75)
- 可直接应用于噪声过滤

### 3. 降级H5
- 包大小效应过弱
- 作为次要发现或放弃

### 4. 研究方向调整
- **推荐方向**: 基于实体距离的噪声过滤/去噪
- **搁置方向**: 分布适应 (需更多理论支持)

---

## 数据来源声明

所有实验使用真实数据:

| 数据集 | 来源 | 样本数 |
|--------|------|--------|
| NYT10 | Aliyun OSS (OpenNRE) | 522,611 |
| NYT-H | Google Drive | 9,955 |

**无合成/模拟数据**

---

## 文件索引

```
results/
├── h1_real_model/
│   └── h1_results.json          # H1真实模型结果
├── h3_entity_distance/
│   ├── h3_results.json          # H3修订版结果
│   └── h3_relation_details.json # 各关系详情
├── h5_fixed/
│   └── h5_results.json          # H5结果
└── final_report.md              # 本报告
```
