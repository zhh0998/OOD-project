# CLINC150 异配性-Betti数相关性验证实验报告

## 实验目标

验证核心假设：**高异配性节点 → 高Betti数**

## 实验方法

### 数据集
- **CLINC150** (clinc_oos, plus配置)
- 原始样本量：15,250
- 采样量：2,000
- 类别数：151

### 图构建方法
- 节点：每个文本样本
- 边：基于TF-IDF向量的余弦相似度
- 相似度阈值：0.5
- 图规模：2,000节点，2,559边

### 异配性计算
```
节点异配率 (NHR) = 1 - (同类邻居数 / 总邻居数)
```

### Betti数计算
- 使用Vietoris-Rips复形方法
- 计算每个节点2-hop Ego-Graph的拓扑特征
- 提取 β₀ (连通分量), β₁ (环路), β₂ (空洞)

## 实验结果

### 核心统计指标

| 指标 | 高NHR组 (n=428) | 低NHR组 (n=697) | 差异 |
|------|-----------------|-----------------|------|
| β₁ 均值 | 184.90 | 23.51 | +686% |
| β₁ 标准差 | 321.75 | 45.59 | - |

### 效应量分析

| Betti维度 | Cohen's d | Pearson r | 效应判定 |
|-----------|-----------|-----------|----------|
| β₀ | -0.2924 | -0.0712 | 微小 |
| **β₁** | **0.7024** | **0.3027** | **中等偏大** |
| β₂ | 0.5080 | 0.2037 | 中等 |

### 假设检验

- **T统计量**: 13.0198
- **p-value**: < 0.000001 (高度显著)
- **Pearson相关系数**: 0.3027 (p < 0.001)
- **Spearman相关系数**: 0.3784 (p < 0.001)

## 判定结果

### 判断标准
| Cohen's d 范围 | 判定结果 |
|----------------|----------|
| d >= 0.5 | 假设成立，全面推进TDA方案 |
| 0.3 <= d < 0.5 | 中等效应，可作为辅助特征 |
| d < 0.3 | 假设不成立，考虑其他方案 |

### 最终结论

**假设成立**

- Cohen's d = **0.7024** (> 0.5 阈值)
- 高异配性节点的Ego-Graph确实展现出更复杂的拓扑结构
- β₁ (环路数) 是最有效的区分特征
- β₂ (空洞数) 也展现出中等效应 (d = 0.508)

## 建议

基于实验结果，**建议全面推进TDA（拓扑数据分析）方案**：

1. **特征工程**：将Betti数（特别是β₁和β₂）作为节点特征用于下游任务
2. **OOD检测**：利用高异配性-高Betti数的关联进行分布外样本识别
3. **图神经网络增强**：将拓扑特征与GNN结合，增强异配性图的表示学习

## 输出文件

1. `clinc150_heterophily_betti_analysis.py` - 完整实验脚本
2. `nhr_betti_correlation.png` - NHR与Betti数相关性可视化
3. `nhr_betti_analysis.png` - 详细分析图（箱线图、热力图等）
4. `statistics_results.txt` - 详细统计结果

---
*实验日期：2025-12-03*
